#!/usr/bin/env ruby

$stdout.sync = $stderr.sync = true

require "bundler/setup"
Bundler.require

require_relative "../lib/black_swan"

# initialization/configuration
DB = Sequel.connect(BlackSwan::Config.database_url)

spiders = []
spiders << BlackSwan::Spiders::Goodreads if ENV["GOODREADS_ID"]
spiders << BlackSwan::Spiders::Twitter   if ENV["TWITTER_HANDLE"]

spiders.each do |spider|
  Timeout.timeout(60) do
    puts "running=#{spider.name}"
    spider.new.run
  end
end
